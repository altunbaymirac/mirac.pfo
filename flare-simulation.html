<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLARE MESH SIMULATOR | MIRAÃ‡ ALTUNBAY</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="flare-simulation.css">
</head>
<body>
    <div class="overlay"></div>
    <div class="terminal flare-terminal">
        <header>
            <div class="system-meta">
                [SYSTEM: FLARE EMERGENCY MESH NETWORK] <br>
                [UNIT: AGU MECHANICAL ENGINEERING] <br>
                [STATUS: <span id="system-status">STANDBY</span>]
            </div>
            <div class="header-right">
                <div id="clock">00:00:00</div>
                <a href="index.html" class="back-btn">[â† ANA SAYFA]</a>
            </div>
        </header>

        <!-- TUTORIAL OVERLAY -->
        <div id="tutorial-overlay" class="tutorial-overlay">
            <div class="tutorial-content">
                <div class="tutorial-header">
                    <h2>ğŸ“ FLARE SÄ°MÃœLATÃ–R REHBERÄ°</h2>
                    <button class="tutorial-skip" onclick="skipTutorial()">[ATLA]</button>
                </div>
                
                <div class="tutorial-steps">
                    <div class="tutorial-step active" data-step="1">
                        <div class="step-icon">ğŸ“¡</div>
                        <h3>FLARE Nedir?</h3>
                        <p>FLARE, deprem gibi afetlerde GSM altyapÄ±sÄ± Ã§Ã¶ktÃ¼ÄŸÃ¼nde <strong>LoRa tabanlÄ± mesh aÄŸ</strong> ile haberleÅŸme saÄŸlayan bir acil durum sistemidir.</p>
                        <div class="step-detail">
                            <strong>GerÃ§ek DÃ¼nya Ã–rneÄŸi:</strong><br>
                            6 Åubat 2023 depreminde GSM kuleleri saatlerce Ã§alÄ±ÅŸmadÄ±. FLARE ile her telefon/cihaz bir "mini kule" olur ve mesajlar zincir ÅŸeklinde iletilir.
                        </div>
                    </div>
                    
                    <div class="tutorial-step" data-step="2">
                        <div class="step-icon">ğŸ”—</div>
                        <h3>Mesh AÄŸ NasÄ±l Ã‡alÄ±ÅŸÄ±r?</h3>
                        <p>Geleneksel aÄŸlarda tÃ¼m cihazlar TEK bir baz istasyonuna baÄŸlÄ±dÄ±r. O dÃ¼ÅŸerse â†’ herkes kopuk.</p>
                        <p>Mesh aÄŸda her cihaz hem ALICI hem VERÄ°CÄ°. Bir yol kapanÄ±rsa â†’ alternatif yol bulunur.</p>
                        <div class="comparison-box">
                            <div class="comp-item bad">
                                <span>âŒ GSM</span>
                                <small>Tek nokta baÄŸÄ±mlÄ±lÄ±ÄŸÄ±</small>
                            </div>
                            <div class="comp-item good">
                                <span>âœ… MESH</span>
                                <small>DaÄŸÄ±tÄ±k, dayanÄ±klÄ±</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tutorial-step" data-step="3">
                        <div class="step-icon">ğŸ“»</div>
                        <h3>LoRa Parametreleri</h3>
                        <p><strong>SF (Spreading Factor):</strong> Sinyal yayÄ±lma faktÃ¶rÃ¼</p>
                        <ul>
                            <li>SFâ†‘ = Menzilâ†‘ ama HÄ±zâ†“</li>
                            <li>SF7: ~2km, hÄ±zlÄ± | SF12: ~15km, yavaÅŸ</li>
                        </ul>
                        <p><strong>BW (Bandwidth):</strong> Bant geniÅŸliÄŸi</p>
                        <ul>
                            <li>BWâ†“ = Menzilâ†‘ ama daha az veri</li>
                        </ul>
                        <p><strong>TX Power:</strong> Verici gÃ¼cÃ¼ (dBm)</p>
                    </div>
                    
                    <div class="tutorial-step" data-step="4">
                        <div class="step-icon">ğŸ®</div>
                        <h3>SimÃ¼lasyonu Kullanma</h3>
                        <ul>
                            <li><strong>Node Ekle:</strong> Sol panelden butona bas</li>
                            <li><strong>Node SeÃ§:</strong> Haritada tÄ±kla</li>
                            <li><strong>Mesaj GÃ¶nder:</strong> Node'a Ã§ift tÄ±kla</li>
                            <li><strong>Node TaÅŸÄ±:</strong> SÃ¼rÃ¼kle-bÄ±rak</li>
                            <li><strong>Senaryo:</strong> Deprem modunu dene!</li>
                        </ul>
                    </div>
                    
                    <div class="tutorial-step" data-step="5">
                        <div class="step-icon">ğŸš€</div>
                        <h3>HazÄ±rsÄ±n!</h3>
                        <p>Åimdi mesh aÄŸÄ± simÃ¼le edebilirsin. Dene:</p>
                        <ol>
                            <li>"DEPREM" senaryosuna geÃ§</li>
                            <li>Bir node'a Ã§ift tÄ±kla ve mesaj gÃ¶nder</li>
                            <li>MesajÄ±n hop-by-hop yayÄ±lÄ±ÅŸÄ±nÄ± izle</li>
                            <li>Bir node'u kapat, aÄŸÄ±n adapte oluÅŸunu gÃ¶r</li>
                        </ol>
                    </div>
                </div>
                
                <div class="tutorial-nav">
                    <button class="tutorial-btn" id="prev-btn" onclick="prevStep()" disabled>[â† GERÄ°]</button>
                    <div class="tutorial-dots" id="tutorial-dots"></div>
                    <button class="tutorial-btn primary" id="next-btn" onclick="nextStep()">[Ä°LERÄ° â†’]</button>
                </div>
            </div>
        </div>

        <!-- INFO TOOLTIP -->
        <div id="info-tooltip" class="info-tooltip" style="display:none;">
            <div class="tooltip-content" id="tooltip-content"></div>
        </div>

        <!-- SCENARIO BAR -->
        <div class="scenario-bar">
            <div class="scenario-info">
                <span class="scenario-label">SENARYO:</span>
                <span id="scenario-name" class="scenario-name">NORMAL OPERASYON</span>
                <button class="help-btn" onclick="showInfo('scenario')">?</button>
            </div>
            <div class="scenario-buttons">
                <button class="scenario-btn active" onclick="setScenario('normal')">
                    [ğŸ“¶ NORMAL]
                </button>
                <button class="scenario-btn danger" onclick="setScenario('earthquake')">
                    [ğŸ”´ DEPREM - GSM Ã‡Ã–KTÃœ]
                </button>
                <button class="scenario-btn" onclick="setScenario('flood')">
                    [ğŸŒŠ SEL]
                </button>
            </div>
            <div class="network-status">
                <span class="status-item">
                    <span class="status-dot" id="gsm-dot"></span>
                    GSM: <span id="gsm-status">ONLINE</span>
                </span>
                <span class="status-item">
                    <span class="status-dot active" id="mesh-dot"></span>
                    MESH: <span id="mesh-status">AKTÄ°F</span>
                </span>
            </div>
            <button class="tutorial-reopen" onclick="reopenTutorial()">[ğŸ“– REHBER]</button>
        </div>

        <!-- MAIN GRID -->
        <main class="flare-grid">
            
            <!-- LEFT: CONTROLS -->
            <section class="panel controls-panel">
                <h3>> KONTROL PANELÄ°</h3>
                
                <!-- LoRa Parameters -->
                <div class="param-section">
                    <h4>// LORA PARAMETRELERÄ° <button class="help-btn small" onclick="showInfo('lora')">?</button></h4>
                    
                    <div class="control-group">
                        <label>
                            SPREADING FACTOR (SF)
                            <span class="info-icon" data-info="SF arttÄ±kÃ§a menzil artar, hÄ±z dÃ¼ÅŸer. Afet durumunda yÃ¼ksek SF tercih edilir.">â“˜</span>
                        </label>
                        <div class="btn-row">
                            <button class="param-btn" onclick="setParam('sf', 7)" title="~2km, hÄ±zlÄ± veri">7</button>
                            <button class="param-btn" onclick="setParam('sf', 9)" title="~5km, orta hÄ±z">9</button>
                            <button class="param-btn active" onclick="setParam('sf', 10)" title="~8km, dengeli">10</button>
                            <button class="param-btn" onclick="setParam('sf', 12)" title="~15km, yavaÅŸ">12</button>
                        </div>
                        <span class="param-info">SFâ†‘ = Menzilâ†‘, HÄ±zâ†“</span>
                    </div>

                    <div class="control-group">
                        <label>
                            BANDWIDTH (kHz)
                            <span class="info-icon" data-info="DÃ¼ÅŸÃ¼k BW = uzun menzil ama yavaÅŸ. YÃ¼ksek BW = kÄ±sa menzil ama hÄ±zlÄ±.">â“˜</span>
                        </label>
                        <div class="btn-row">
                            <button class="param-btn" onclick="setParam('bw', 125)" title="Uzun menzil">125</button>
                            <button class="param-btn active" onclick="setParam('bw', 250)" title="Dengeli">250</button>
                            <button class="param-btn" onclick="setParam('bw', 500)" title="HÄ±zlÄ± veri">500</button>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>
                            TX POWER (dBm)
                            <span class="info-icon" data-info="Verici gÃ¼cÃ¼. YÃ¼ksek gÃ¼Ã§ = uzun menzil ama pil tÃ¼ketimi artar.">â“˜</span>
                        </label>
                        <div class="slider-container">
                            <input type="range" id="tx-power" min="2" max="20" value="14">
                            <span class="slider-value" id="tx-power-val">14 dBm</span>
                        </div>
                    </div>
                </div>

                <!-- Node Actions -->
                <div class="param-section">
                    <h4>// NODE Ä°ÅLEMLERÄ°</h4>
                    
                    <button class="action-btn" onclick="addNode()">
                        [+ NODE EKLE]
                    </button>
                    
                    <button class="action-btn" onclick="addSurvivor()">
                        [ğŸ‘¤ KURBAN EKLE]
                    </button>
                    
                    <button class="action-btn danger" onclick="toggleNodeMode()">
                        <span id="node-mode-text">[ğŸ”´ NODE KAPAT MODU]</span>
                    </button>
                    
                    <button class="action-btn" onclick="resetNetwork()">
                        [â†º AÄI SIFIRLA]
                    </button>
                </div>

                <!-- Quick Stats -->
                <div class="stats-section">
                    <h4>// AÄ Ä°STATÄ°STÄ°KLERÄ°</h4>
                    <div class="stat-row">
                        <span>AKTÄ°F NODE:</span>
                        <span id="stat-nodes" class="stat-value">0/0</span>
                    </div>
                    <div class="stat-row">
                        <span>BAÄLANTI:</span>
                        <span id="stat-connections" class="stat-value">0</span>
                    </div>
                    <div class="stat-row">
                        <span>MENZÄ°L:</span>
                        <span id="stat-range" class="stat-value">0 px</span>
                    </div>
                    <div class="stat-row">
                        <span>MESAJ TESLÄ°M:</span>
                        <span id="stat-delivery" class="stat-value">-</span>
                    </div>
                </div>

                <!-- Info Box -->
                <div class="info-box">
                    <span class="info-label">// FLARE NEDÄ°R?</span>
                    <p>Afet durumlarÄ±nda GSM Ã§Ã¶ktÃ¼ÄŸÃ¼nde LoRa mesh aÄŸ ile haberleÅŸme saÄŸlar.</p>
                    <p>Her node hem alÄ±cÄ± hem verici â†’ Tek noktaya baÄŸÄ±mlÄ±lÄ±k yok!</p>
                </div>
            </section>

            <!-- CENTER: NETWORK MAP -->
            <section class="panel map-panel">
                <h3>> AÄ TOPOLOJÄ°SÄ° <span id="map-mode-indicator"></span></h3>
                <div class="map-container">
                    <canvas id="network-canvas"></canvas>
                    <!-- Mesaj gÃ¶nderme overlay -->
                    <div id="message-overlay" class="message-overlay" style="display:none;">
                        <div class="message-popup">
                            <h4>[ğŸ“¡ ACÄ°L MESAJ GÃ–NDER]</h4>
                            <p class="popup-desc">Bu mesaj tÃ¼m aÄŸa yayÄ±lacak. GerÃ§ek FLARE sisteminde GPS koordinatlarÄ± da eklenir.</p>
                            <input type="text" id="msg-input" placeholder="YARDIM! ENKAZ ALTINDAYIM..." maxlength="100">
                            <div class="popup-buttons">
                                <button onclick="sendMessage()">[ğŸ“¡ GÃ–NDER]</button>
                                <button onclick="closeMessagePopup()">[Ä°PTAL]</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="map-legend">
                    <span class="legend-item"><span class="legend-dot node-gateway"></span> GATEWAY (Ana Ä°stasyon)</span>
                    <span class="legend-item"><span class="legend-dot node-active"></span> AKTÄ°F NODE</span>
                    <span class="legend-item"><span class="legend-dot node-inactive"></span> DEVRE DIÅI</span>
                    <span class="legend-item"><span class="legend-dot node-survivor"></span> KURBAN/KULLANICI</span>
                    <span class="legend-item"><span class="legend-line"></span> LoRa BAÄLANTI</span>
                </div>
                <div class="map-instructions">
                    ğŸ’¡ TIKLA: Node seÃ§ | Ã‡Ä°FT TIKLA: Mesaj gÃ¶nder | SÃœRÃœKLE: TaÅŸÄ±
                </div>
            </section>

            <!-- RIGHT: LOGS & METRICS -->
            <section class="panel logs-panel">
                <h3>> Ä°LETÄ°ÅÄ°M LOGLARI</h3>
                
                <!-- Message propagation visualization -->
                <div class="propagation-display">
                    <div class="prop-header">
                        <span>SON MESAJ YAYILIMI</span>
                        <span id="prop-progress">0%</span>
                    </div>
                    <div class="prop-bar">
                        <div class="prop-fill" id="prop-fill"></div>
                    </div>
                    <div class="prop-stats">
                        <span>HOP: <span id="prop-hops">-</span></span>
                        <span>SÃœRE: <span id="prop-time">-</span></span>
                        <span>ULAÅAN: <span id="prop-reached">-</span></span>
                    </div>
                    <div class="prop-explanation">
                        <small>HOP = MesajÄ±n kaÃ§ node'dan geÃ§tiÄŸi. Mesh aÄŸda mesaj "zÄ±playarak" yayÄ±lÄ±r.</small>
                    </div>
                </div>

                <!-- Log display -->
                <div id="log-display" class="log-display">
                    <div class="log-entry system">[SYSTEM] FLARE Mesh Simulator v2.0 baÅŸlatÄ±ldÄ±...</div>
                    <div class="log-entry system">[SYSTEM] Rehber iÃ§in saÄŸ Ã¼stteki ğŸ“– butonuna tÄ±klayÄ±n.</div>
                </div>

                <!-- Selected node info -->
                <div class="node-info-panel" id="node-info" style="display:none;">
                    <h4>> SEÃ‡Ä°LÄ° NODE: <span id="selected-node-id">-</span></h4>
                    <div class="node-stats">
                        <div class="node-stat" title="AlÄ±nan sinyal gÃ¼cÃ¼. -50 mÃ¼kemmel, -110 zayÄ±f.">
                            <span class="label">RSSI</span>
                            <span class="value" id="node-rssi">-</span>
                        </div>
                        <div class="node-stat" title="Sinyal/GÃ¼rÃ¼ltÃ¼ oranÄ±. YÃ¼ksek = temiz sinyal.">
                            <span class="label">SNR</span>
                            <span class="value" id="node-snr">-</span>
                        </div>
                        <div class="node-stat" title="Bu node'un baÄŸlÄ± olduÄŸu diÄŸer node sayÄ±sÄ±.">
                            <span class="label">BAÄLANTI</span>
                            <span class="value" id="node-connections">-</span>
                        </div>
                        <div class="node-stat" title="Bu node Ã¼zerinden geÃ§en mesaj sayÄ±sÄ±.">
                            <span class="label">MESAJ</span>
                            <span class="value" id="node-messages">-</span>
                        </div>
                    </div>
                    <div class="node-actions">
                        <button onclick="sendFromSelected()">[ğŸ“¡ MESAJ GÃ–NDER]</button>
                        <button onclick="toggleSelectedNode()">[ğŸ”´ DEVRE DIÅI]</button>
                    </div>
                </div>

                <!-- RSSI Scale -->
                <div class="rssi-scale">
                    <h4>// SÄ°NYAL KALÄ°TESÄ° (RSSI) <button class="help-btn small" onclick="showInfo('rssi')">?</button></h4>
                    <div class="scale-bar">
                        <div class="scale-section excellent">-50</div>
                        <div class="scale-section good">-70</div>
                        <div class="scale-section fair">-90</div>
                        <div class="scale-section weak">-110</div>
                        <div class="scale-section none">-130</div>
                    </div>
                    <div class="scale-labels">
                        <span>MÃœKEMMEl</span>
                        <span>ZAYIF</span>
                    </div>
                </div>

                <!-- Why This Matters -->
                <div class="why-box">
                    <h4>// NEDEN Ã–NEMLÄ°?</h4>
                    <p>ğŸ”¹ 6 Åubat depreminde GSM saatlerce Ã§Ã¶ktÃ¼</p>
                    <p>ğŸ”¹ Enkaz altÄ±ndaki insanlar iletiÅŸim kuramadÄ±</p>
                    <p>ğŸ”¹ FLARE ile her cihaz bir "mini kule" olur</p>
                    <p>ğŸ”¹ Mesajlar zincir ÅŸeklinde iletilebilir</p>
                </div>
            </section>
        </main>

        <!-- FOOTER -->
        <footer class="flare-footer">
            <span>[AGÃœ MAKÄ°NE MÃœHENDÄ°SLÄ°ÄÄ°]</span>
            <span>[FLARE EMERGENCY MESH NETWORK]</span>
            <span>[v2.0 INTERACTIVE SIMULATOR]</span>
        </footer>
    </div>

    <!-- INFO MODAL -->
    <div id="info-modal" class="info-modal" style="display:none;">
        <div class="info-modal-content">
            <h3 id="info-modal-title">Bilgi</h3>
            <div id="info-modal-body"></div>
            <button onclick="closeInfoModal()" class="info-modal-close">[KAPAT]</button>
        </div>
    </div>

    <script src="flare-simulation.js"></script>
</body>
</html>
